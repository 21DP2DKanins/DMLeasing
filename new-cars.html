<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Car Listings</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <div class="wrapper">
      <header class="header">
          <div class="container">
            <div class="header__inner">
              <a href="index.html" class="logo">
                <img src="images/logo.svg" alt="" class="logo__img">
              </a>
              <nav class="menu">
                <ul class="menu__list">
                  <li class="menu__list-item"><a href="#" class="menu__list-link menu__list-link--active" onclick="fetchCars('Sedan')">NEW CARS</a></li>
                  <li class="menu__list-item"><a href="contacts.html" class="menu__list-link">CONTACT US</a></li>
                </ul>
              </nav>
            </div>
          </div>
      </header>
      <main class="main">
        <section class="choose">
          <div class="container">
            <h2 class="section-title">Choose your car</h2>
            <div class="search">
              <input type="text" id="search-make" placeholder="Make" class="search__input">
              <input type="number" id="search-price" placeholder="Starting Price" class="search__input">
              <input type="number" id="search-year" placeholder="Year" class="search__input">
              <button onclick="searchCars()" class="search__button">Search</button>
            </div>
            <div class="tabs">
              <div class="tabs__btn">
                <button class="tabs__btn-item" data-button="content-1" onclick="fetchCars('Sedan')">Sedan</button>
                <button class="tabs__btn-item" data-button="content-2" onclick="fetchCars('Electric')">Electric</button>
                <button class="tabs__btn-item" data-button="content-3" onclick="fetchCars('SUV')">SUV</button>
                <button class="tabs__btn-item" data-button="content-4" onclick="fetchCars('Sports')">Sports</button>
              </div>
              <div class="tabs__content">
                <div class="tabs__content-item tabs__content-item--active" id="content-1"></div>
                <div class="tabs__content-item" id="content-2"></div>
                <div class="tabs__content-item" id="content-3"></div>
                <div class="tabs__content-item" id="content-4"></div>
              </div>
            </div>
          </div>
        </section>
        <section class="blog">
          <div class="container">
            <div class="blog__items">
              <div class="blog__item">
                <img class="blog__item-img" src="images/blog-1.jpg" alt="">
                <h4 class="blog__item-title">An easier way to buy your next Toyota</h4>
                <a href="#" class="blog__item-link">more</a>
              </div>
              <div class="blog__item">
                <img class="blog__item-img" src="images/blog-2.jpg" alt="">
                <h4 class="blog__item-title">A Guide to Road-Tripping With Pets</h4>
                <a href="#" class="blog__item-link">more</a>
              </div>
            </div>
            <a href="#" class="showmore-link">SHOW MORE</a>
          </div>
        </section>
      </main>
      <footer class="footer">
        <div class="container">
          <nav class="footer__menu">
            <ul class="footer__menu-list">
              <li class="footer__menu-item"><p class="footer__menu-title">Products</p></li>
              <li class="footer__menu-item"><a href="#" class="footer__menu-link">Used</a></li>
              <li class="footer__menu-item"><a href="#" class="footer__menu-link">New</a></li>
              <li class="footer__menu-item"><a href="#" class="footer__menu-link">Sell your car</a></li>
            </ul>
            <ul class="footer__menu-list">
              <li class="footer__menu-item"><p class="footer__menu-title">Resources</p></li>
              <li class="footer__menu-item"><a href="#" class="footer__menu-link">Blog</a></li>
              <li class="footer__menu-item"><a href="#" class="footer__menu-link">FAQ</a></li>
              <li class="footer__menu-item"><a href="#" class="footer__menu-link">Contact us</a></li>
            </ul>
            <ul class="footer__menu-list">
              <li class="footer__menu-item"><p class="footer__menu-title">Work With TrueCar</p></li>
              <li class="footer__menu-item"><a href="#" class="footer__menu-link">Dealers</a></li>
              <li class="footer__menu-item"><a href="#" class="footer__menu-link">Partners</a></li>
            </ul>
            <ul class="footer__menu-list">
              <li class="footer__menu-item"><p class="footer__menu-title">About</p></li>
              <li class="footer__menu-item"><a href="#" class="footer__menu-link">About us</a></li>
              <li class="footer__menu-item"><a href="#" class="footer__menu-link">Team</a></li>
              <li class="footer__menu-item"><a href="#" class="footer__menu-link">Careers</a></li>
            </ul>
          </nav>
          <ul class="app">
            <li class="app__item">
              <a href="#" class="app__item-link">
                <img class="app__item-img" src="images/appstore.svg" alt="">
              </a>
            </li>
            <li class="app__item">
              <a href="#" class="app__item-link">
                <img class="app__item-img" src="images/googleplay.svg" alt="">
              </a>
            </li>
          </ul>
          <div class="footer__copy">
            <p class="footer__copy-text">
              For questions about the TrueCar Auto Buying Service please call 1-888-878-3227.
Certified Dealers are contractually obligated by TrueCar to meet certain customer service requirements and complete the TrueCar Dealer Certification Program.
            </p>
            <p class="footer__copy-text">
              TrueCar does not broker, sell, or lease motor vehicles. Unless otherwise noted, all vehicles shown on this website are offered for sale by licensed motor vehicle dealers. All vehicles are subject to prior sale. By accessing this website, you agree to the TrueCar Terms of Service and Privacy Policy.
            </p>
          </div>
          <nav class="copy__nav">
            <ul class="copy__nav-list">
              <li class="copy__nav-item"><a href="#" class="copy__nav-link">Terms of Service</a></li>
              <li class="copy__nav-item"><a href="#" class="copy__nav-link">Privacy Policy</a></li>
              <li class="copy__nav-item"><a href="#" class="copy__nav-link">Do Not Sell My Personal Information</a></li>
            </ul>
          </nav>
        </div>
      </footer>
  </div>
  <script>
    document.addEventListener('DOMContentLoaded', async function() {
        await fetchCars('Sedan');
    });

    async function fetchCars(type, make = '', price = '', year = '') {
      try {
        const url = new URL('http://127.0.0.1:5000/cars');
        url.searchParams.append('type', type);
        if (make) url.searchParams.append('make', make);
        if (price) url.searchParams.append('price', price);
        if (year) url.searchParams.append('year', year);

        const response = await fetch(url);
        const cars = await response.json();

        const contentContainer = document.getElementById('content-1');
        contentContainer.innerHTML = '';

        cars.forEach(car => {
          const card = createCard(car);
          contentContainer.appendChild(card);
        });
      } catch (error) {
        console.error('Error fetching car data:', error);
      }
    }

    function searchCars() {
      const make = document.getElementById('search-make').value;
      const price = document.getElementById('search-price').value;
      const year = document.getElementById('search-year').value;
      fetchCars('Sedan', make, price, year);
    }

    function createCard(car) {
      const card = document.createElement('div');
      card.classList.add('card');

      const cardImage = document.createElement('img');
      cardImage.classList.add('card__img');
      cardImage.src = car.img_url;
      cardImage.alt = car.name;

      const cardContent = document.createElement('div');
      cardContent.classList.add('card__content');

      const cardTitle = document.createElement('h4');
      cardTitle.classList.add('card__title');
      cardTitle.textContent = car.name;

      const cardText = document.createElement('p');
      cardText.classList.add('card__text');
      cardText.textContent = `Starting from $${car.cost}`;

      const cardPrice = document.createElement('p');
      cardPrice.classList.add('card__price');
      cardPrice.textContent = `$${car.costPerMonth}/mo`;

      cardContent.appendChild(cardTitle);
      cardContent.appendChild(cardText);
      cardContent.appendChild(cardPrice);

      card.appendChild(cardImage);
      card.appendChild(cardContent);

      return card;
    }
  </script>
</body>
</html>
